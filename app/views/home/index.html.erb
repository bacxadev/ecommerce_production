<div data-layout-mode="light"  data-sidebar-size="default" data-theme-layout="vertical" class="bg-[#EEF0FC] dark:bg-gray-900">
  <div class="ltr:flex flex-1 rtl:flex-row-reverse">
      <div class="page-wrapper relative ltr:ml-auto rtl:mr-auto rtl:ml-0 w-[calc(100%-120px)] px-4 pt-[64px] duration-300">
          <div class="xl:w-full">
              <div class="flex flex-wrap">
                  <div class="flex items-center py-4 w-full">
                      <div class="w-full">
                          <div class="">
                              <div class="flex flex-wrap justify-between">
                                  <div class="items-center ">
                                      <h1 class="font-medium text-3xl block dark:text-slate-100">Ecommerce</h1>
                                      <ol class="list-reset flex text-sm">
                                          <li><a href="#" class="text-gray-500 dark:text-slate-400">Robotech</a></li>
                                          <li><span class="text-gray-500 dark:text-slate-400 mx-2">/</span></li>
                                          <li class="text-gray-500 dark:text-slate-400">Dashboard</li>
                                          <li><span class="text-gray-500 dark:text-slate-400 mx-2">/</span></li>
                                          <li class="text-primary-500 hover:text-primary-600 dark:text-primary-400">Ecommerce</li>
                                      </ol>
                                  </div>
                                  <div class="flex items-center">
                                      <div class="today-date leading-5 mt-2 lg:mt-0 form-input w-auto rounded-md border inline-block border-primary-500/60 dark:border-primary-500/60 text-primary-500 bg-transparent px-3 py-1 focus:outline-none focus:ring-0 placeholder:text-slate-400/70 placeholder:font-normal placeholder:text-sm hover:border-primary-400 focus:border-primary-500 dark:focus:border-primary-500  dark:hover:border-slate-700">
                                          <input type="text" style="max-width: 300px !important; width: 250px !important;" class="dash_date border-0 focus:border-0 focus:outline-none flatpickr-input" readonly  required="">
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>

          <div id="main-data">
            <div class="xl:w-full  min-h-[calc(100vh-138px)] relative pb-14" id="main-admin">
              <div class="grid grid-cols-12 sm:grid-cols-12 md:grid-cols-12 lg:grid-cols-12 xl:grid-cols-12 gap-4">
                  <div class="col-span-12 sm:col-span-12 md:col-span-6 lg:col-span-3 xl:col-span-3">
                      <div class="bg-white shadow-sm dark:shadow-slate-700/10 dark:bg-gray-900  rounded-md w-full relative mb-4">
                          <div class="flex-auto p-4">
                              <div class="flex justify-between xl:gap-x-2 items-cente">
                                  <div class="self-center">
                                      <p class="text-gray-800 font-semibold dark:text-slate-400 uppercase">Total Revenue</p>
                                      <h3 class="my-4 font-semibold text-[30px] dark:text-slate-200">$<%= @total_revenue.round(2) %></h3>
                                  </div>
                                  <div class="self-center">
                                    <i data-lucide="circle-dollar-sign" class=" h-16 w-16 stroke-yellow-500/30"></i>
                                  </div>
                              </div>
                          </div><!--end card-body-->
                          <div class="flex-auto p-4 pt-0 -mt-1">
                              <div class="grid grid-cols-12 sm:grid-cols-12 md:grid-cols-12 lg:grid-cols-12 xl:grid-cols-12 gap-4" style="min-width: 420px;">
                              </div>
                          </div><!--end card-body-->
                      </div> <!--end inner-grid-->
                  </div><!--end col-->

                  <div class="col-span-12 sm:col-span-12 md:col-span-6 lg:col-span-3 xl:col-span-3">
                      <div class="bg-white shadow-sm dark:shadow-slate-700/10 dark:bg-gray-900  rounded-md w-full relative mb-4">
                          <div class="flex-auto p-4">
                              <div class="flex justify-between xl:gap-x-2 items-cente">
                                  <div class="self-center">
                                      <p class="text-gray-800 font-semibold dark:text-slate-400 uppercase">Total Orders</p>
                                      <h3 class="my-4 font-semibold text-[30px] dark:text-slate-200"><%= @total_order %></h3>
                                  </div>
                                  <div class="self-center">
                                      <i data-lucide="gem" class=" h-16 w-16 stroke-yellow-500/30"></i>
                                  </div>
                              </div>
                          </div><!--end card-body-->
                      </div> <!--end inner-grid-->
                  </div>
                  <div class="col-span-12 sm:col-span-12 md:col-span-6 lg:col-span-3 xl:col-span-3">
                      <div class="bg-white shadow-sm dark:shadow-slate-700/10 dark:bg-gray-900  rounded-md w-full relative mb-4">
                          <div class="flex-auto p-4">
                              <div class="flex justify-between xl:gap-x-2 items-cente">
                                  <div class="self-center">
                                      <p class="text-gray-800 font-semibold dark:text-slate-400 uppercase">CONVERSION RATE</p>
                                      <h3 class="my-4 font-semibold text-[30px] dark:text-slate-200 text-red-500">
                                        <% if @total_customers == 0 %>
                                            <%= 0 %>%
                                          <% else %>
                                            <%= ((@total_order.to_f/@total_customers.to_f)*100).round(2) %>%
                                          <% end %>
                                      </h3>
                                  </div>
                                  <div class="self-center">
                                      <i data-lucide="star" class=" h-16 w-16 stroke-yellow-500/30"></i>
                                  </div>
                              </div>
                          </div><!--end card-body-->
                      </div> <!--end inner-grid-->
                  </div>

                  <div class="col-span-12 sm:col-span-6 md:col-span-6 lg:col-span-3 xl:col-span-3">
                      <div class="bg-white shadow-sm dark:shadow-slate-700/10 dark:bg-gray-900  rounded-md w-full relative mb-4">
                          <div class="flex-auto p-4">
                              <div class="flex justify-between xl:gap-x-2 items-cente">
                                  <div class="self-center">
                                      <p class="text-gray-800 font-semibold dark:text-slate-400 text-lg uppercase">Total Checkout</p>
                                      <h3 class="my-4 font-semibold text-[30px] dark:text-slate-200"><%= @total_checkout || 0 %></h3>
                                  </div>
                                  <div class="self-center">
                                      <i data-lucide="shopping-cart" class=" h-16 w-16 stroke-primary-500/30"></i>
                                  </div>
                              </div>
                          </div><!--end card-body-->
                      </div> <!--end inner-grid-->
                  </div><!--end col-->

                  <div class="col-span-12 sm:col-span-6 md:col-span-6 lg:col-span-3 xl:col-span-3">
                      <div class="bg-white shadow-sm dark:shadow-slate-700/10 dark:bg-gray-900  rounded-md w-full relative mb-4">
                          <div class="flex-auto p-4">
                              <div class="flex justify-between xl:gap-x-2 items-cente">
                                  <div class="self-center">
                                      <p class="text-gray-800 font-semibold dark:text-slate-400 text-lg uppercase">Total Visitor</p>
                                      <h3 class="my-4 font-semibold text-[30px] dark:text-slate-200"><%= @total_customers || 0 %></h3>
                                  </div>
                                  <div class="self-center">
                                      <i data-lucide="users" class=" h-16 w-16 stroke-green/30"></i>
                                  </div>
                              </div>
                          </div><!--end card-body-->
                      </div> <!--end inner-grid-->
                  </div><!--end col-->
                  <div class="col-span-12 sm:col-span-12 md:col-span-6 lg:col-span-3 xl:col-span-3">
                      <div class="bg-white shadow-sm dark:shadow-slate-700/10 dark:bg-gray-900  rounded-md w-full relative mb-4">
                          <div class="flex-auto p-4">
                              <div class="flex justify-between xl:gap-x-2 items-cente">
                                  <div class="self-center">
                                      <p class="text-gray-800 font-semibold dark:text-slate-400 uppercase">AVERAGE ORDER VALUE</p>
                                      <h3 class="my-4 font-semibold text-[30px] dark:text-slate-200">$<%= @total_order == 0 ? 0:(@total_revenue.to_f/@total_order).round(2) %></h3>
                                  </div>
                                  <div class="self-center">
                                      <i data-lucide="shopping-bag" class=" h-16 w-16 stroke-green/30"></i>
                                  </div>
                              </div>
                          </div><!--end card-body-->
                      </div> <!--end inner-grid-->
                  </div>

              </div> <!--end grid-->
              <div class="grid grid-cols-12 sm:grid-cols-12 md:grid-cols-12 lg:grid-cols-12 xl:grid-cols-12 gap-4 mb-4">
                  <div class="col-span-12 sm:col-span-12  md:col-span-12 lg:col-span-6 xl:col-span-6 ">
                      <div class="bg-white shadow-sm dark:shadow-slate-700/10 dark:bg-gray-900   rounded-md w-full relative">
                          <div class="border-b border-dashed border-slate-200 dark:border-slate-700 py-4 px-4 dark:text-slate-300/70">
                              <h4 class="font-medium flex-1 self-center mb-2 md:mb-0 text-xxl">Earnings Reports by Domain</h4>
                              <p class="text-sm text-slate-400">Earnings Reports Last Week <span class="focus:outline-none text-[11px] bg-brand-500/10 text-brand-500 dark:text-brand-300 rounded font-medium py-[2px] px-2">$18532</span></p>
                          </div><!--end header-title-->
                          <div class="grid grid-cols-1 p-4">
                              <div class="sm:-mx-6 lg:-mx-8">
                                  <div class="relative overflow-x-auto block w-full sm:px-6 lg:px-8">
                                      <table class="w-full">
                                          <thead class="bg-brand-400/10 dark:bg-slate-700/20">
                                              <tr>
                                                  <th scope="col" class="p-3 text-base font-medium tracking-wider text-start text-gray-700 uppercase dark:text-gray-400">
                                                      Domain
                                                  </th>
                                                  <th scope="col" class="p-3 text-base font-medium tracking-wider text-start text-gray-700 uppercase dark:text-gray-400">
                                                      Total Orders
                                                  </th>
                                                  <th scope="col" class="p-3 text-base font-medium tracking-wider text-start text-gray-700 uppercase dark:text-gray-400">
                                                      Conversion Rate
                                                  </th>
                                                  <th scope="col" class="p-3 text-base font-medium tracking-wider text-start text-gray-700 uppercase dark:text-gray-400">
                                                      Revenue
                                                  </th>
                                              </tr>
                                          </thead>
                                          <tbody>
                                              <% @total_domains.each do |domain| %>
                                                  <tr class="bg-white border-b border-dashed dark:bg-gray-900 dark:border-gray-700/40">
                                                      <td class="p-3 text-base  text-gray-600 whitespace-nowrap dark:text-gray-400">
                                                          <%= domain[:domain_name] %>
                                                      </td>
                                                      <td class="p-3 text-base text-gray-500 whitespace-nowrap dark:text-gray-400">
                                                          <%= domain[:total_order] %>
                                                      </td>
                                                      <td class="p-3 text-base text-gray-500 whitespace-nowrap dark:text-gray-400">
                                                      <span class="text-red-500"><%= (( domain[:total_order].to_f / domain[:total_customers].to_f )*100).round(2) %> %</span>
                                                      </td>
                                                      <td class="p-3 text-base text-gray-700 whitespace-nowrap dark:text-gray-400">
                                                          <span class="font-semibold">$<%= domain[:total_revenue] %></span>
                                                      </td>
                                                  </tr>
                                              <% end %>
                                              <!-- 2 -->
                                          </tbody>
                                      </table>
                                  </div>
                              </div>
                          </div><!--end card-body-->
                      </div> <!--end card-->
                  </div><!--end col-->
                  <div class="col-span-12 sm:col-span-12  md:col-span-12 lg:col-span-6 xl:col-span-6 ">
                      <div class="bg-white shadow-sm dark:shadow-slate-700/10 dark:bg-gray-900   rounded-md w-full relative">
                          <div class="border-b border-dashed border-slate-200 dark:border-slate-700 py-4 px-4 dark:text-slate-300/70">
                              <h4 class="font-medium flex-1 self-center mb-2 md:mb-0 text-xxl">Most Populer Products</h4>
                              <p class="text-sm text-slate-400">New Products Last Week <span class="focus:outline-none text-[11px] bg-brand-500/10 text-brand-500 dark:text-brand-300 rounded font-medium py-[2px] px-2">5</span></p>
                          </div><!--end header-title-->
                          <div class="grid grid-cols-1 p-4">
                              <div class="sm:-mx-6 lg:-mx-8">
                                  <div class="relative overflow-x-auto block w-full sm:px-6 lg:px-8">
                                      <table class="w-full">
                                          <thead class="bg-brand-400/10 dark:bg-slate-700/20">
                                              <tr>
                                                  <th scope="col" class="p-3 text-base font-medium tracking-wider text-start text-gray-700 uppercase dark:text-gray-400">
                                                      Product
                                                  </th>
                                                  <th scope="col" class="p-3 text-base font-medium tracking-wider text-start text-gray-700 uppercase dark:text-gray-400">
                                                      Visitor
                                                  </th>
                                                  <th scope="col" class="p-3 text-base font-medium tracking-wider text-start text-gray-700 uppercase dark:text-gray-400">
                                                      Orders
                                                  </th>
                                                  <th scope="col" class="p-3 text-base font-medium tracking-wider text-start text-gray-700 uppercase dark:text-gray-400">
                                                      CR
                                                  </th>
                                                  <th scope="col" class="p-3 text-base font-medium tracking-wider text-start text-gray-700 uppercase dark:text-gray-400">
                                                      Revenue
                                                  </th>
                                              </tr>
                                          </thead>
                                          <tbody id="data-container">
                                            <% @products.each do |products| %>
                                              <tr class="bg-white border-b border-dashed dark:bg-gray-900 dark:border-gray-700/40">
                                                <td class="p-3 text-base font-medium whitespace-nowrap dark:text-white" title="<%= products[:product_name] %>">
                                                  <%= truncate(products[:product_name], length: 35) %><br/>
                                                <small class="text-gray-400"><%= products[:domain_name] %></small>
                                                </td>
                                                <td class="p-3 text-base text-gray-500 whitespace-nowrap dark:text-gray-400">
                                                  <%= products[:visitor] %>
                                                </td>
                                                <td class="p-3 text-base text-gray-500 whitespace-nowrap dark:text-gray-400">
                                                  <%= products[:order_count] %>
                                                </td>
                                                <td class="p-3 text-base text-gray-500 whitespace-nowrap dark:text-gray-400">
                                                <span class="text-red-500">
                                                  <%= products[:visitor].to_i == 0 ? 0 : ((products[:order_count].to_f / products[:visitor].to_i)* 100).round(2) %>
                                                %</span>
                                                </td>
                                                <td class="p-3 text-base text-gray-500 whitespace-nowrap dark:text-gray-400">$ <%= products[:revenue] %></td>
                                              </tr>
                                            <% end %>
                                          </tbody>
                                      </table>
                                      </br>
                                      <div style="display: flex; justify-content: center;">
                                        <%== pagy_nav(@pagy) %>
                                      </div>
                                  </div>
                              </div>
                          </div><!--end card-body-->
                      </div> <!--end card-->
                  </div><!--end col-->
              </div><!--end inner-grid-->
              <!-- footer -->
              <div class="absolute bottom-0 -left-4 -right-4 block print:hidden border-t p-4 h-[52px] dark:border-slate-700/40">
                <div class="container">
                  <!-- Footer Start -->
                  <footer
                    class="footer bg-transparent  text-center  font-medium text-slate-600 dark:text-slate-400 md:text-left "
                  >
                    &copy;
                    Robotech
                    <span class="float-right hidden text-slate-600 dark:text-slate-400 md:inline-block"
                      >Crafted with <i class="ti ti-heart text-red-500"></i> by
                      Mannatthemes</span
                    >
                  </footer>
                  <!-- end Footer -->
                </div>
              </div>
            </div><!--end container-->
          </div>
      </div>
  </div>

  <script>
    try{
      var options = {



        chart: {
            height:80,
            animations: {
                enabled: false
            },
            sparkline: {
                enabled: true
            },
            dropShadow: {
              enabled: true,
              top: 12,
              left: 0,
              bottom: 0,
              right: 0,
              blur: 2,
              color: "rgba(132, 145, 183, 0.3)",
              opacity: 0.35,
            },
            type:"bar"
        },
        plotOptions: {
            bar: {
                horizontal: false,
                endingShape: "rounded",
                columnWidth: "40%"
            }
        },
        dataLabels: {
            enabled: false
        },
        stroke: {
            show: true,
            width: 2,
            colors: ["transparent"]
        },
        colors: ["#5C3DC3"],
        series:[ {
            name: "Orders",
            data: [50, 60, 70, 80, 90, 100, 95, 85, 75, 65, 55, 65, 75, 85, 95, 105, 80, 70, 60, 50, 40, 30, 45, 55, 65, 75, 85, 95, 100, 80, 60]
        }
        ],
        xaxis: {
            categories: ['1-Jan','2-Jan','3-Jan','4-Jan','5-Jan','6-Jan','7-Jan','8-Jan','9-Jan','10-Jan','11-Jan','12-Jan','13-Jan','14-Jan','15-Jan','16-Jan','17-Jan','18-Jan','19-Jan','20-Jan','21-Jan','22-Jan','23-Jan','24-Jan','25-Jan','26-Jan','27-Jan','28-Jan','29-Jan','30-Jan','31-Jan'],
            crosshairs: {
                show: false,
            },
        },
        fill: {
            opacity: 0.9
        },

        tooltip: {
            y: {
                formatter:function(val) {
                    return" "+val+" "
                },
            },
        }

    }
    var chart = new ApexCharts(
        document.querySelector("#apex_column1"),
        options
      );

      chart.render();
    }catch(err){}


    try{
      var dash_spark_1 = {

        chart: {
            type: 'area',
            height: 80,
            sparkline: {
                enabled: true
            },
            dropShadow: {
              enabled: true,
              top: 12,
              left: 0,
              bottom: 0,
              right: 0,
              blur: 2,
              color: "rgba(132, 145, 183, 0.3)",
              opacity: 0.35,
            },
        },
        stroke: {
            curve: 'smooth',
            width: 1
          },
        fill: {
            opacity: 0.05,
        },
        series: [{
          data: [4, 8, 5, 10, 4, 16, 5, 11, 6, 11, 30, 10, 13, 4, 6, 3, 6]
        }],
        yaxis: {
            min: 0
        },
        colors: ['#00be82'],
      }
      new ApexCharts(document.querySelector("#dash_spark_1"), dash_spark_1).render();
    }catch (err){}

    try{
    var options = {
      chart: {
        height: 100,
        type: "donut",
        dropShadow: {
          enabled: true,
          top: 12,
          left: 0,
          bottom: 0,
          right: 0,
          blur: 2,
          color: "rgba(132, 145, 183, 0.3)",
          opacity: 0.35,
        },
      },
      plotOptions: {
        pie: {
          donut: {
            size: "75%",
          },
        },
      },
      dataLabels: {
        enabled: false,
      },

      stroke: {
        show: true,
        width: 2,
        colors: ["transparent"],
      },

      series: [50, 25, 25],
      legend: {
        show: false,
        position: "right",
        horizontalAlign: "center",
        verticalAlign: "middle",
        floating: false,
        fontSize: "13px",
        offsetX: 0,
        offsetY: 0,
      },
      labels: ["Mobile", "Tablet", "Desktop"],
      colors: ["#fd3d97", "#5d78ff", "#35bfa3"],

      responsive: [
        {
          breakpoint: 600,
          options: {
            plotOptions: {
              donut: {
                customScale: 0.2,
              },
            },
            chart: {
              height: 240,
            },
            legend: {
              show: false,
            },
          },
        },
      ],
      tooltip: {
        y: {
          formatter: function (val) {
            return val + " %";
          },
        },
      },
    };

    var chart = new ApexCharts(document.querySelector("#ana_device"), options);
    chart.render();

    }catch (err) {}

    try{
      var options = {
        chart: {
            height: 350,
            type: 'area',
            width: '100%',
            stacked: true,
            toolbar: {
              show: false,
              autoSelected: 'zoom'
            },
            dropShadow: {
              enabled: true,
              top: 12,
              left: 0,
              bottom: 0,
              right: 0,
              blur: 2,
              color: "rgba(132, 145, 183, 0.3)",
              opacity: 0.35,
            },
        },
        colors: ['#1b1b22', '#fa6432'],
        dataLabels: {
            enabled: false
        },
        stroke: {
            curve: 'straight',
            width: [2, 0.5],
            dashArray: [0, 3],
            lineCap: 'round',
        },
        grid: {
          padding: {
            left: 0,
            right: 0
          },
          strokeDashArray: 3,
        },
        markers: {
          size: 0,
          hover: {
            size: 0
          }
        },
        series: [{
            name: 'Last Year',
            data: [0,60,20,90,45,110,55,130,44,110,75,120]
        }, {
            name: 'This Year',
            data: [0,45,10,75,35,94,40,115,30,105,65,110]
        }],

        xaxis: {
            type: 'month',
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            axisBorder: {
              show: true,
            },
            axisTicks: {
              show: true,
            },
        },
        fill: {
          type: "gradient",
          gradient: {
            shadeIntensity: 1,
            opacityFrom: 0.4,
            opacityTo: 0.1,
            stops: [0, 90, 100]
          }
        },

        tooltip: {
            x: {
                format: 'dd/MM/yy HH:mm'
            },
        },
        legend: {
          position: 'top',
          horizontalAlign: 'right'
        },
      }

      var chart = new ApexCharts(
        document.querySelector("#crm-dash"),
        options
      );

      chart.render();

      }catch (err) {}


      try{
        var options = {
          chart: {
              height: 205,
              type: 'donut',
          },
          plotOptions: {
            pie: {
              donut: {
                size: '85%'
              }
            }
          },
          dataLabels: {
            enabled: false,
            },
            stroke: {
              show: true,
              width: 2,
              colors: ['transparent']
          },

          series: [10, 65, 25,],
          legend: {
              show: false,
              position: 'bottom',
              horizontalAlign: 'center',
              verticalAlign: 'middle',
              floating: false,
              fontSize: '14px',
              offsetX: 0,
              offsetY: 5
          },
          labels: [ "Mobile", "Tablet", "Desktop"],
          colors: ["#13939c", "#603dc3", "#fac639"],

          responsive: [{
              breakpoint: 600,
              options: {
                plotOptions: {
                    donut: {
                      customScale: 0.2
                    }
                  },
                  chart: {
                      height: 200
                  },
                  legend: {
                      show: false
                  },
              }
          }],

          tooltip: {
            y: {
                formatter: function (val) {
                    return   val + " %"
                }
            }
          }
        }

        var chart = new ApexCharts(
          document.querySelector("#email_report"),
          options
        );

        chart.render();
      }catch(err){}
      </script>
      <script>
        class App {

      init() {

        const html = document.querySelector("html");
        const toggletheme = document.querySelector("#toggle-theme");
        const lightBtn = toggletheme?.querySelector('.light');
        const darkBtn = toggletheme?.querySelector('.dark');
        toggletheme?.addEventListener('click', () => {

          if (html.getAttribute('class') === "dark") {
            document.body.setAttribute("data-layout-mode", "light")
          } else {
            document.body.setAttribute("data-layout-mode", "dark")
          }

          html.classList.toggle("dark");
          const isDark = html.classList.contains('dark');
          (!isDark?darkBtn:lightBtn)?.classList.add('hidden');
          (isDark?darkBtn:lightBtn)?.classList.remove('hidden');

          // togglethemeicon.className = "ti ti-" + `${themeIcon}` + "  top-icon";
        })
      }
    }




    window.addEventListener('DOMContentLoaded', function (e) {
      new App().init();
    })

    try {
      // Icon
      lucide.createIcons();
    } catch (err) { }
    /*********************/
    /*   Toggle menu     */
    /*********************/
    try {
      document.getElementById("toggle-menu").addEventListener("click", function(){
        var mobileMenu = document.getElementById("mobile-menu-2");
        mobileMenu.classList.toggle("hidden");
        // if (mobileMenu.classList.contains('block')) {
        //   mobileMenu.classList.remove("hidden");
        // }else{
        //   mobileMenu.classList.add("hidden");
        // }
      })

    } catch (err) { }

    /*********************/
    /*   Menu Sticky     */
    /*********************/
    function windowScroll() {
      const navbar = document.getElementById("topbar");
      if (navbar != null) {
        if (
          document.body.scrollTop >= 50 ||
          document.documentElement.scrollTop >= 50
        ) {
          navbar.classList.add("nav-sticky");
        } else {
          navbar.classList.remove("nav-sticky");
        }
      }
    }

    window.addEventListener('scroll', (ev) => {
      ev.preventDefault();
      windowScroll();
    })




    /*********************/
    /*  Vertical Menu     */
    /*********************/
    function activeMenu() {


      function activeTwoColumn() {
        function activeTabMenu() {
          document.querySelectorAll('.tab-menu button').forEach((e) => {
            e.setAttribute('aria-selected', false);
          })
        }
        activeTabMenu();

        document.querySelectorAll('#Icon-menu a').forEach(function (element, index) {
          var pageUrl = window.location.href.split(/[?#]/)[0];
          const target = element;

          if (element.href == pageUrl) {
            // tabPanelList list link active
            document.querySelectorAll('#Icon-menu [role="tabpanel"]').forEach(function (elem) {
              elem.classList.add('hidden');
              elem.querySelectorAll('.collapse-menu').forEach(function (accorElem) {
                accorElem.classList.add('hidden');
              });
            });

            target.classList.add('active');
            target.parentNode.classList.add('menuitem-active');
            let tabNode = null;
            if (target.parentNode.parentNode.parentNode.hasAttribute("role")) {
              target.parentNode.parentNode.parentNode.classList.remove('hidden');
              tabNode = target.parentNode.parentNode.parentNode;
            }
            if (target.parentNode.parentNode.parentNode.classList.contains("collapse-menu")) {
              target.parentNode.parentNode.parentNode.classList.remove('hidden');
              tabNode = target.parentNode.parentNode.parentNode;
            }
            if (target.parentNode.parentNode.parentNode.previousElementSibling) {
              target.parentNode.parentNode.parentNode.previousElementSibling.querySelector('.nav-link').classList.add('active');
              target.parentNode.parentNode.parentNode.previousElementSibling.querySelector('[data-accordion-icon]')?.classList.add('rotate-180');
              target.parentNode.parentNode.parentNode.previousElementSibling.querySelector('.nav-link').setAttribute('aria-expanded', "true");
              if (target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.hasAttribute("role")) {
                target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.classList.remove('hidden');
                tabNode = target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
              }
            }

            if (tabNode) {
              document.querySelectorAll(`.tab-menu button[data-tabs-target="#${tabNode.id}"]`).forEach((e) => {
                // e.setAttribute('aria-selected', true);
                e.click();
              })
            }
          }
        });
      }


      function activeHorizontal() {
        if (document.querySelector('nav#topbar')) {
          document.querySelectorAll('nav#topbar ul.NavMenu a').forEach(function (element, index) {
            var pageUrl = window.location.href.split(/[?#]/)[0];
            const target = element;


            if (element.href == pageUrl) {
                console.info(element);
                element.classList.add("active")
                element.parentElement.parentElement.parentElement.querySelector('a')?.classList.add('active');
                element.parentElement.parentElement.parentElement.parentElement.parentElement.querySelector('a')?.classList.add('active');
            }
          });
        }
      }


      function activeLeftbar(){
        document.querySelectorAll('ul.navbar-nav a.nav-link').forEach(function (element, index) {
          var pageUrl = window.location.href.split(/[?#]/)[0];
          if(pageUrl===element.href){
            element.classList.add('active');
            const parent = element.parentElement.parentElement.parentElement.previousElementSibling;

            const pPrent = parent.parentElement.parentElement.parentElement.previousElementSibling;
            if(pPrent?.hasAttribute('data-fc-type')){
              frost.Collapse.getInstanceOrCreate(pPrent).show();
            }

            if(parent?.hasAttribute('data-fc-type')){
              frost.Collapse.getInstanceOrCreate(parent).show();
            }// element.
          }
        });
      }

      activeLeftbar();
      activeTwoColumn();
      activeHorizontal();


    }

    window.addEventListener("load", (event) => {
      activeMenu();
    });



    try {
      // Toggle menu
      document.getElementById("toggle-menu").addEventListener("click", function () {
        var mobileMenu = document.getElementById("mobile-menu-2");
        mobileMenu.classList.toggle("block");
        if (mobileMenu.classList.contains('block')) {
          mobileMenu.classList.remove("hidden");
        } else {
          mobileMenu.classList.add("hidden");
        }
      })
    } catch (err) { }





    // Default Mode
    document.getElementById('default-size-check')?.addEventListener('click', () => {
      document.body.setAttribute("data-sidebar-size", "default")
    });



    //collapsed
    var collapsedToggle = document.querySelector(".button-menu-mobile");
    collapsedToggle?.addEventListener('click', function () {

      var sidebarSize = document.body.getAttribute("data-sidebar-size");

      if (sidebarSize == "collapsed") {
        document.body.setAttribute("data-sidebar-size", "default")

      } else {
        document.body.setAttribute("data-sidebar-size", "collapsed")
      }

    });

    window.addEventListener('resize', () => {
      if (window.innerWidth >= 282 && window.innerWidth <= 1440) {
        document.body.setAttribute("data-sidebar-size", "collapsed")
      } else {
        document.body.setAttribute("data-sidebar-size", "default")
      }
    })

    //collapsed
    var collapsedToggle = document.querySelector(".button-menu-mobile-2");
    collapsedToggle?.addEventListener('click', function () {

      var sidebarSize = document.body.getAttribute("data-sidebar-size");

      if (sidebarSize == "collapsed") {
        document.body.setAttribute("data-sidebar-size", "default")
        // document.getElementById('default-size-check').checked = true;

      } else {
        document.body.setAttribute("data-sidebar-size", "collapsed")
      }

    });



    function dismissDropdownMenu() {
      document.querySelectorAll(".dropdown-menu").forEach(function (item) {
        item.classList.remove("block")
        item.classList.add("hidden")
      });
      document.querySelectorAll(".dropdown-toggle").forEach(function (item) {
        item.classList.remove("block")
      });
    }

    window.addEventListener('click', function (e) {
      dismissDropdownMenu();
    });


    try {
      window.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll(".drop-multi button, .second-level a").forEach(el => {
          el.addEventListener('click', function () {
            this.nextElementSibling.classList.toggle('block');
            this.parentNode.classList.toggle('block');
          });
        });
      });

      // data-tw-auto-close
      Array.from(document.querySelectorAll(".dropdown-toggle")).forEach(function (item) {
        var elem = item.parentElement
        if (item.getAttribute('data-tw-auto-close') == 'outside') {
          elem.querySelector(".dropdown-menu").addEventListener("click", function () {
            if (!isShowDropMenu) {
              isShowDropMenu = true;
            }
          });
        } else if (item.getAttribute('data-tw-auto-close') == 'inside') {
          item.addEventListener("click", function () {
            isShowDropMenu = true;
            isMenuInside = true;
          });
          elem.querySelector(".dropdown-menu").addEventListener("click", function () {
            isShowDropMenu = false;
            isMenuInside = false;
          });
        }
      });

      // window.addEventListener('click', function (e) {
      //   if (!isShowDropMenu && !isMenuInside) {
      //     dismissDropdownMenu();
      //   }
      //   isShowDropMenu = false;
      // });

    } catch (err) { }


    try{
      function convertToLosAngelesTime(date) {
        var inputDate = new Date(date);
        var losAngelesTime = new Date(inputDate.toLocaleString("en-US", {timeZone: "America/Los_Angeles"}));
        return losAngelesTime;
      }
      var losAngelesDate = convertToLosAngelesTime(new Date());
      flatpickr(".dash_date", {
        defaultDate: losAngelesDate,
        dateFormat: "d-M-Y",
        mode: "range"
      });
    } catch (err){}


    try{
    function initDateRangrPicker() {
      if ($('#Dash_Date').length == 0) {
          return;
      }

      var picker = $('#Dash_Date');
      var start = moment();
      var end = moment();

      function cb(start, end, label) {
          var title = '';
          var range = '';

          if ((end - start) < 100 || label == 'Today') {
              title = 'Today:';
              range = start.format('MMM D');
          } else if (label == 'Yesterday') {
              title = 'Yesterday:';
              range = start.format('MMM D');
          } else {
              range = start.format('MMM D') + ' - ' + end.format('MMM D');
          }

          picker.find('#Select_date').html(range);
          picker.find('#Day_Name').html(title);
      }

      picker.daterangepicker({
          startDate: start,
          endDate: end,
          opens: 'left',
          applyClass: "btn btn-sm btn-primary",
          cancelClass: "btn btn-sm btn-secondary",
          ranges: {
              'Today': [moment(), moment()],
              'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
              'Last 7 Days': [moment().subtract(6, 'days'), moment()],
              'Last 30 Days': [moment().subtract(29, 'days'), moment()],
              'This Month': [moment().startOf('month'), moment().endOf('month')],
              'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
          }
      }, cb);

      cb(start, end, '');
    }
    } catch (err) { }

  </script>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const urlParams = new URLSearchParams(window.location.search);
  const dateTimeParam = urlParams.get('date_time');

  const commonFlatpickrOptions = {
    dateFormat: "d/M/Y",
    mode: "range",
    onChange: function(selectedDates, dateStr, instance) {
      if (selectedDates.length === 2) {
        const startDate = moment(selectedDates[0]).format("DD/MM/YYYY");
        const endDate = moment(selectedDates[1]).format("DD/MM/YYYY");
        const dateRange = startDate + " - " + endDate;
        const newUrl = "/?date_time=" + encodeURIComponent(dateRange);
        window.location.href = newUrl;
      }
    }
  };

  if (dateTimeParam) {
    const dates = dateTimeParam.split(" - ");
    if (dates.length === 2) {
      const startDate = moment(dates[0], "DD/MM/YYYY").toDate();
      const endDate = moment(dates[1], "DD/MM/YYYY").toDate();
      commonFlatpickrOptions.defaultDate = [startDate, endDate];
    }
  }

  flatpickr(".flatpickr-input", commonFlatpickrOptions);
});
</script>
</div>

<style>
  .pagy-nav.pagination {
    display: flex;
    list-style: none;
    padding: 0;
    margin: 0;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    font-family: Arial, sans-serif;
  }

  .pagy-nav .page {
    margin: 0 0.25rem;
  }

  .pagy-nav .page a {
    text-decoration: none;
    color: #007bff;
    padding: 0.5rem 0.75rem;
    border-radius: 0.25rem;
    border: 1px solid #dee2e6;
    transition: background-color 0.3s, color 0.3s;
  }

  .pagy-nav .page a:hover {
    background-color: #007bff;
    color: #fff;
  }

  .pagy-nav .page.active {
    font-weight: bold;
    padding: 0.5rem 0.75rem;
    border-radius: 0.25rem;
    border: 1px solid #007bff;
    background-color: #007bff;
    color: #fff;
  }

  .pagy-nav .page.disabled {
    color: #6c757d;
    padding: 0.5rem 0.75rem;
    border-radius: 0.25rem;
    border: 1px solid #dee2e6;
    background-color: #f8f9fa;
    cursor: not-allowed;
  }

  .pagy-nav .page.disabled a {
    color: #6c757d;
    pointer-events: none;
    text-decoration: none;
  }
</style>
